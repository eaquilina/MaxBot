# syntax = docker/dockerfile:experimental
FROM ubuntu
RUN apk add --no-cache openssh-client.git
RUN mkdir -p -m 0700 ~/.ssh && ssh-keyscan github.com >> ~/.ssh/known_hosts


MAINTAINER tappiera00@gmail.com

ENV DEBIAN_FRONTEND=noninteractive

RUN \
  apt-get update && apt-get install -y gnupg2 && \
  apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 9DA31620334BD75D9DCB49F368818C72E52529D4 && \
  echo 'deb [arch=amd64,arm64] http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/4.0 multiverse' | tee /etc/apt/sources.list.d/mongodb-org-4.0.list && \
  apt-get update && apt-get install -y \
#  --no-install-recommends apt-utils \
  mongodb-org \
#  git \
  openssh-client \
#  python-pip \
#  python-dev \
  python-setuptools
 

#VOLUME ["/home/p3rditus/Desktop/data/mongodb"]
#WORKDIR /home/p3rditus/Desktop/data

EXPOSE 27017
CMD ["mongod"]

#ENV HOME /media/p3rditus/maxbot_1
ENV HOME /root
RUN ssh-keygen -f /root/.ssh/id_rsa -q -N ""
#\
#    && pip install markupsafe dopy boto linode-python pyrax


#RUN apk add --no-cache openssh-client.git
#RUN mkdir -p -m 0600 ~/.ssh && ssh-keyscan github.com >> ~/.ssh/known_hosts

RUN --mount=type=ssh pip install git+ssh://git@github.com/enricoaquilina/MaxBot.git@develop
#RUN --mount=type=ssh mkdir -p -m 0600 ~/.ssh && ssh-keyscan github.com >> ~/.ssh/known_hosts
WORKDIR /media/p3rditus/maxbot_1
#RUN --mount=type=ssh git clone git@github.com/enricoaquilina/MaxBot.git MaxBot
